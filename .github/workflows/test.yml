on:
  - push
jobs:
  test:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v2
      - run: |
          sudo apt update
          sudo apt install build-essential -y
          sudo apt install qtbase5-dev qt5-qmake libmpv-dev zlib1g-dev qt5-default -y
      - run: qmake build.pro
      - run: make -j $(nproc)
      - run: make install INSTALL_ROOT=AppDir
      - run: |
          wget https://github.com/linuxdeploy/linuxdeploy/releases/download/continuous/linuxdeploy-x86_64.AppImage
          wget https://github.com/linuxdeploy/linuxdeploy-plugin-qt/releases/download/continuous/linuxdeploy-plugin-qt-x86_64.AppImage
          chmod +x linuxdeploy*.AppImage
      - run: ./linuxdeploy-x86_64.AppImage --appdir AppDir --plugin qt
